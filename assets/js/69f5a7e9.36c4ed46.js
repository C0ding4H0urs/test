(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9187],{3905:function(e,n,r){"use strict";r.d(n,{Zo:function(){return c},kt:function(){return m}});var t=r(7294);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function i(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function l(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=t.createContext({}),u=function(e){var n=t.useContext(s),r=n;return e&&(r="function"==typeof e?e(n):i(i({},n),e)),r},c=function(e){var n=u(e.components);return t.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},p=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(r),m=a,$=p["".concat(s,".").concat(m)]||p[m]||d[m]||o;return r?t.createElement($,i(i({ref:n},c),{},{components:r})):t.createElement($,i({ref:n},c))}));function m(e,n){var r=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=p;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var u=2;u<o;u++)i[u]=r[u];return t.createElement.apply(null,i)}return t.createElement.apply(null,r)}p.displayName="MDXCreateElement"},4818:function(e,n,r){"use strict";r.r(n),r.d(n,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return u},toc:function(){return c},default:function(){return p}});var t=r(2122),a=r(9756),o=(r(7294),r(3905)),i=["components"],l={sidebar_position:5,title:"View Rank"},s=void 0,u={unversionedId:"leveling/view-rank",id:"leveling/view-rank",isDocsHomePage:!1,title:"View Rank",description:"This command manages viewing the rank of yourself, or a given member.",source:"@site/docs/leveling/view-rank.md",sourceDirName:"leveling",slug:"/leveling/view-rank",permalink:"/leveling/view-rank",editUrl:"https://github.com/yagpdb-cc/yagpdb-cc/edit/master/website/docs/leveling/view-rank.md",version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5,title:"View Rank"},sidebar:"tutorialSidebar",previous:{title:"Message Handler",permalink:"/leveling/message-handler"},next:{title:"Set XP/Level",permalink:"/leveling/set-xp"}},c=[],d={toc:c};function p(e){var n=e.components,r=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,t.Z)({},d,r,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This command manages viewing the rank of yourself, or a given member."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Trigger Type:")," ",(0,o.kt)("inlineCode",{parentName:"p"},"Regex")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Trigger:")," ",(0,o.kt)("inlineCode",{parentName:"p"},"\\A(-|<@!?204255221017214977>\\s*)(rank|lvl|xp)(\\s+|\\z)")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Usage:"),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("inlineCode",{parentName:"p"},"-rank [member]"),(0,o.kt)("br",{parentName:"p"}),"\n","You may also set a color for your rank card using ",(0,o.kt)("inlineCode",{parentName:"p"},"-rank set-color <hex>")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"-rank set-color default"),".",(0,o.kt)("br",{parentName:"p"}),"\n","You may also set a background for your rank card (if enabled) using ",(0,o.kt)("inlineCode",{parentName:"p"},"-rank set-background <link>")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"-rank set-background del"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'{{/*\n    This command manages viewing the rank of a given member.\n    Use by running `-rank [member]` where member is optional. Defaults to yourself.\n    You may also set a color for your rank card using `-rank set-color <hex>` or `-rank set-color default`.\n    You may also set a background for your rank card (if enabled) using `-rank set-background <link>` or `-rank set-background del`.\n\n    Recommended trigger: Regex trigger with trigger `\\A(-|<@!?204255221017214977>\\s*)(rank|lvl|xp)(\\s+|\\z)`.\n*/}}\n{{/* CONFIGURATION AREA STARTS */}}\n{{ $rankcard := false }} {{/* set to `true` for a rank card */}}\n{{ $background := "https://xbox-store-checker.com/assets/upload/game/2020/06/optimize/9n5qmw0x81jm-background.jpg" }}{{/* background for rankcard, dont edit if you dont use it */}}\n{{/* CONFIGURATION AREA ENDS*/}}\n{{/* Instantiate constants */}}\n{{ $barEmpty := "\u25a1" }}\n{{ $barFull := "\u25a0" }}\n{{ $xp := 0 }} {{/* Xp of user */}}\n{{ $color := 14232643 }} {{/* Embed color */}}\n{{ $user := .User }} {{/* Target user */}}\n{{ $colorSet := false }}\n\n{{ with .CmdArgs }}\n    {{ $temp := userArg (index . 0) }}\n    {{ if $temp }}\n        {{ $user = $temp }}\n        {{ with dbGet $user.ID "xpColor" }} {{ $color = .Value }} {{ end }}\n    {{ else if and (eq (index . 0) "set-color") (ge (len .) 2) }}\n        {{ $colorSet = true }}\n        {{ $multipliers := cslice 1048576 65536 4096 256 16 1 }}\n        {{ $hex2dec := sdict "A" 10 "B" 11 "C" 12 "D" 13 "E" 14 "F" 15 }}\n        {{ with reFindAllSubmatches `\\A(?:#?default|([a-fA-F\\d]{1,6}))\\z` (joinStr " " (slice . 1)) }}\n            {{ $hex := "D92C43" }}\n            {{ with index . 0 1 }}\n                {{ $hex = (printf "%06s" .) | upper }}\n            {{ end }}\n            {{ $dec := 0 }}\n            {{ range $k, $v := split $hex "" -}}\n                {{- $multiplier := index $multipliers $k }}\n                {{- $num := or ($hex2dec.Get $v) $v}}\n                {{- $dec = add $dec (mult $num $multiplier) -}}\n            {{ end }}\n            {{ dbSet $user.ID "xpColor" $dec }}\n            {{ dbSet $user.ID "hex" $hex }}\n            {{ $user.Mention }}, I set your rank card color to `#{{ $hex }}`.\n        {{ else }}\n            Please provide a valid hex to set your rank card color to.\n        {{ end }}\n    {{ end }}\n{{ end }}\n{{ if not $colorSet }}\n    {{/* Get the color for this user */}}\n    {{ with dbGet $user.ID "xpColor" }} {{ $color = .Value }} {{ end }}\n    {{ with dbGet $user.ID "xp" }}\n        {{ $xp = .Value }}\n    {{ end }} {{/* If XP is there, use that */}}\n\n    {{ $level := roundFloor (mult 0.1 (sqrt $xp)) }} {{/* Calculate level */}}\n    {{ $current := sub $xp (mult 100 $level $level) }} {{/* current XP for this level */}}\n    {{ if lt (toInt $xp) 100 }}\n        {{ $current = $xp }}\n    {{ end }} {{/* If this level < level 1, use total XP as current */}}\n\n    {{ $nextLvl := add $level 1 }} {{/* Next level */}}\n    {{ $total := sub (mult 100 $nextLvl $nextLvl) (mult 100 $level $level) }} {{/* The total until next level */}}\n    {{ $percentage := (mult (fdiv $current $total) 100) | roundFloor }} {{/* Start with percentage calculations */}}\n    {{ $percentage = div $percentage 10 | toInt }} {{/* Percentage out of 10 */}}\n\n    {{ $bar := "" }} {{/* The progress bar */}}\n    {{ range seq 1 11 }}\n        {{- if ge $percentage . }} {{- $bar = joinStr "" $bar $barFull }} {{/* We join with full bar unicode if percentage > current iteration */}}\n        {{- else }} {{- $bar = joinStr "" $bar $barEmpty }} {{- end -}} {{/* Otherwise, join with empty bar */}}\n    {{ end }}\n\n    {{ $embed := sdict\n        "title" (printf "\u276f %s\'s Rank" $user.String)\n        "color" $color\n        "description" (printf\n            "\u276f **%d / %d** XP\\n\u276f **Total:** %d\\n\u276f **Level:** %d\\n\u276f **Progress bar:**\\n[**%s**](https://yagpdb.xyz)"\n            (toInt $current) (toInt $total) (toInt $xp) (toInt $level) $bar)\n    }} {{/* Format embed */}}\n\n    {{ $rank := 0 }} {{/* Current rank of user */}}\n    {{ range $index, $entry := dbTopEntries "xp" 100 0 }} {{- /* Loop over top 100 entries - see if user is in top 100 */}}\n        {{- if eq .UserID $user.ID }} {{- $rank = add $index 1 }} {{- end -}}\n    {{ end }}\n\n    {{ if $rank }}\n        {{ $embed.Set "description" (printf\n            "\ud83c\udfc6 *Member of Top 100*\\n\\n\u276f **Rank:** %d\\n%s"\n            $rank\n            $embed.description\n        ) }} {{/* If user in top 100, update the description */}}\n    {{ end }}\n{{ $bg := true }}\n{{ with .CmdArgs }}\n{{ $bg = false }}\n{{ if and (eq (index . 0) "set-background") (ge (len .) 2) }}\n              {{ if eq (index . 1) "del" }} {{ dbDel $.User.ID "background" }} deleted\n            {{ else if (reFindAllSubmatches `https?:\\/\\/(?:www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,63}\\b(?:(?:(?:,?[-a-zA-Z0-9@:%_\\+.~#?!&/=*]*)|(?:,?\\([-a-zA-Z0-9@:%_\\+.~#?!&/=*]*\\))*|\\[\\])*)` (index . 1)) }}\n            {{ dbSet $.User.ID "background" (index . 1) }} doneso\n    {{ else }} thats not a valid link!\n{{ end }}\n{{ end }}\n{{ end }}\n{{ if ($rankcard) }}\n{{ $rank = or $rank "100" }}\n{{ $username := urlescape ($user.Username) }}\n{{ with dbGet $user.ID "background" }}\n{{ $background = .Value }} {{end}}\n{{$pfp := "https://discord.com/assets/322c936a8c8be1b803cd94861bdfa868.png"}}\n{{if $user.Avatar}} {{$pfp = ($user.AvatarURL "256")}} {{end}}\n\n{{ sendMessage nil (cembed "color" 4645612 "image" (sdict "url" (print "https://vacefron.nl/api/rankcard?username=" $username "&avatar=" $pfp "&level=" $level "&rank=" $rank "&currentxp=" $current "&nextlevelxp=" $total "&previouslevelxp=0&custombg=" $background "&xpcolor=" ((dbGet $user.ID "hex").Value)))) }}\n     {{ else }}\n    {{ sendMessage nil (cembed $embed) }}\n{{ end }}\n{{ end }}\n')))}p.isMDXComponent=!0}}]);